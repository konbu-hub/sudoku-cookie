# 基本設計書・仕様書

**プロジェクト名:** おしゃべりクッキーのSUDOKU (Sudoku Cookie)  
**現行バージョン:** 1.2.5  
**最終更新日:** 2026-01-17

## 1. アプリ概要
「おしゃべりクッキーのSUDOKU」は、従来の静的で静かな数独ゲームに対するアンチテーゼとして開発された、**「煽り」と「爽快感」**をテーマにした革新的な数独アプリです。
プレイヤーの操作に対して生意気なクッキーキャラクターが反応し、時には邪魔をし、時には（稀に）励ますことで、単なるパズル以上のエンターテインメント体験を提供します。

### コンセプト
*   **Mascot Interaction:** プレイヤーを煽る生意気なクッキー。
*   **Cyberpunk UI:** ダークモードを基調とした、ネオンカラー（Cyan, Magenta, Amber）のスタイリッシュなデザイン。
*   **Speed & Comfort:** 「爆速連打モード」や「オートメモ」など、快適なプレイを極限まで追求した操作性。

## 2. 主要機能

### 2.1 ゲームプレイ
*   **難易度設定:** 5段階の難易度を用意。
    *   やわクッキー (Easy)
    *   普通クッキー (Medium)
    *   堅クッキー (Hard)
    *   バリ堅クッキー (Expert)
    *   石 (Extreme)
*   **独自入力システム:**
    *   **クイックモード (Lightning Mode):** 数字を選択した状態で盤面をタップして連続入力。
    *   **オートメモ (Auto Pencil):** 候補数字を自動で計算して埋める機能。
*   **ヒント機能:** 回数制限付き（3回）のヒント機能（使用数に応じてスコア減少）。
*   **演出:**
    *   数字完成時の**Ripple（波動）エフェクト**と控えめなフラッシュ。
    *   マスコット連打時の「激怒モード」および爆発エフェクト。
    *   ゲームクリア時のスコア演出。

### 2.2 マスコット機能
*   **インタラクション:** マスコットをタップするとランダムなセリフで反応。
*   **激怒システム:** 短時間に連打するとマスコットが赤く発光し、画面全体が揺れるなどの「激怒」演出が発生。さらに連打すると強制的にペナルティ（爆発など）が発生する場合がある。
*   **逃走監視:** ゲームを中断（「ビビってやめる」）しようとすると、強烈な煽りメッセージを表示。実際に逃げると「逃走回数」がカウントされ、ランキングに不名誉な記録として残る。

### 2.3 ランキングシステム
*   **ハイブリッド構成:**
    *   **グローバルランキング:** Firebase Firestoreを使用した全プレイヤー共通の累計ポイントランキング。
    *   **タイムアタックランキング:** 難易度別のクリアタイムランキング。
    *   **マイサマリー:** SQLiteを使用したローカルのプレイ履歴と統計情報。
*   **UI:** タブ切り替え式（グローバル / タイムアタック / マイサマリー）。タイムアタックは難易度をボタンで切り替え可能。
*   **逃走ランキング:** 「逃げた回数」を競う（？）裏ランキング実装。

### 2.4 Google Play Games 連携
*   **実績 (Achievements):**
    *   初クリア
    *   スピードマスター (5分以内クリア)
    *   完璧主義者 (ノーミスでクリア)
*   **リーダーボード:** クリアスコアやタイムを送信。

## 3. 技術スタック

### フロントエンド (Mobile App)
*   **Framework:** Flutter (Android / iOS / Web)
*   **Language:** Dart
*   **Architecture:** MVVM (Model-View-ViewModel) + Repository Pattern
*   **State Management:** Provider

### バックエンド (BaaS)
*   **Authentication:** Firebase Auth (匿名認証 + Google Sign-In)
*   **Database:** Cloud Firestore (ランキングデータ)
*   **Analytics:** (将来実装予定) Firebase Analytics

### ローカルデータ
*   **Storage:**
    *   `sqflite`: プレイ履歴、ローカルベストスコア
    *   `shared_preferences`: 設定（BGM/SE音量、テーマ設定）、UUID

### 主要ライブラリ
*   `provider`: 状態管理
*   `flutter_animate`: UIアニメーション
*   `audioplayers`: BGM・SE再生
*   `games_services`: Google Play Games Services連携
*   `cloud_firestore`: リモートDB
*   `glassmorphism`: UIデザインコンポーネント

## 4. デザイン方針
*   **カラーパレット:**
    *   Primary: Indigo (`#1a237e`) - 深い夜空のような背景
    *   Accent 1: Cyan (`#00E5FF`) - デジタルな発光表現
    *   Accent 2: Amber (`#FFC107`) - クッキー、スコア、達成感
    *   Accent 3: Deep Orange (`#FF5722`) - 警告、マスコットの怒り
*   **フォント:** `Orbitron` (タイトル等の装飾), `Noto Sans JP` (本文)
