# バージョニング管理ルール

## 概要

このドキュメントは、Sudoku Cookieアプリのバージョン管理とビルド時のバージョニングルールを定義します。

## バージョン番号の形式

`pubspec.yaml` のバージョン番号は以下の形式を使用します:

```
version: <major>.<minor>.<patch>+<build>
```

例: `1.0.5+8`

- **major**: メジャーバージョン(破壊的変更)
- **minor**: マイナーバージョン(新機能追加)
- **patch**: パッチバージョン(バグフィックス)
- **build**: ビルド番号(Google Playで必須、常にインクリメント)

## ビルド時のルール

### 必須: ビルド番号のインクリメント

**Google Playにアップロードする前に、必ずビルド番号をインクリメントすること**

```yaml
# 修正前
version: 1.0.5+7

# 修正後
version: 1.0.5+8
```

### ビルド手順

1. **バージョン番号の更新**
   ```bash
   # pubspec.yamlのversionフィールドを編集
   # ビルド番号(+の後の数字)を必ずインクリメント
   ```

2. **クリーンビルド(推奨)**
   ```bash
   flutter clean
   flutter pub get
   ```

3. **AABビルド(Google Play用)**
   ```bash
   flutter build appbundle --release
   ```

4. **APKビルド(テスト用、オプション)**
   ```bash
   flutter build apk --release
   ```

## バージョンアップのガイドライン

### ビルド番号(+の後)のインクリメント

**常に**以下の場合にインクリメント:
- Google Playへの新規アップロード
- 内部テスト、クローズドテスト、オープンテストへのアップロード
- 製品版へのアップロード

### パッチバージョン(第3桁)のインクリメント

以下の場合にインクリメント:
- バグフィックス
- 軽微な修正
- パフォーマンス改善

例: `1.0.5+8` → `1.0.6+9`

### マイナーバージョン(第2桁)のインクリメント

以下の場合にインクリメント:
- 新機能の追加
- UI/UXの大幅な改善
- 新しいゲームモードの追加

例: `1.0.6+9` → `1.1.0+10`

### メジャーバージョン(第1桁)のインクリメント

以下の場合にインクリメント:
- 破壊的変更
- アプリの大規模なリニューアル
- APIの大幅な変更

例: `1.1.0+10` → `2.0.0+11`

## 現在のバージョン履歴

| バージョン | ビルド番号 | リリース日 | 変更内容 |
|----------|----------|----------|---------|
| 1.0.5 | 8 | 2026-01-16 | スプラッシュスクリーン修正、AAB再ビルド |
| 1.0.5 | 7 | 2026-01-15 | (前回のビルド) |

## 注意事項

> [!IMPORTANT]
> Google Playは同じビルド番号のAABを受け付けません。必ず前回のビルド番号より大きい値を設定してください。

> [!WARNING]
> ビルド番号は**決して減らさないこと**。常に増加させる必要があります。

> [!TIP]
> ビルド前に `pubspec.yaml` のバージョン番号を確認する習慣をつけましょう。

## チェックリスト

リリースビルド前に以下を確認:

- [ ] `pubspec.yaml` のビルド番号がインクリメントされている
- [ ] バージョン番号が適切(パッチ/マイナー/メジャー)
- [ ] `flutter clean` を実行済み
- [ ] `flutter pub get` を実行済み
- [ ] テストが全て成功している
- [ ] AABファイルが正常に生成されている

## 自動化(将来の改善案)

将来的には以下の自動化を検討:

- CI/CDパイプラインでのバージョン番号自動インクリメント
- Git tagとバージョン番号の同期
- リリースノートの自動生成
